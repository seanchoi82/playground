<?
/* ========================================================================== */
/* =   프로그램 명	:	MobileCancel.php                            = */
/* =   프로그램 설명	:	Mobile 취소 샘플  파일                      = */
/* =   작성일		:	2009-04      		                    = */
/* =   저작권		:	(주)다우기술                                = */
/* ========================================================================== */
?>
<?
/* ========================================================================== */
/* =   데이터 셋업                                               	    = */
/* ========================================================================== */
require "./library/Mobile_library.php";
require "./config/common_config.cfg";

/* ========================================================================== */
/* =   요청 정보 설정                                             	    = */
/* ========================================================================== */
/* = 	 NOT NULL				                            = */
/* ========================================================================== */
$opcode		=	"304";														// 요청(변경불가)
$daoutrx	=	$_POST[ "daoutrx"];	// 다우거래번호
$amount		=	$_POST[ "amount" ];	// 결제금액

/* ========================================================================== */
/* = 	 NULL 허용						            = */
/* ========================================================================== */
$cancelmemo     =	$_POST[ "cancelmemo" ];	// 취소 사유

/* ========================================================================== */
/* = 	 승인 취소 요청							    = */
/* ========================================================================== */
MobileCancel( BIN_URL, SERVER_IP, MOBILE_PORT, CPID, ENCKEY, TIMEOUT );		

/* ========================================================================== */
/* = 	 리턴값 로그							    = */
/* ========================================================================== */   
error_log(print_r($_POST,true));
error_log(print_r('#####'.$_SERVER[PHP_SELF].'#####',true));
error_log("res_resultcode    : ".$res_resultcode    );
error_log("res_errormessage  : ".$res_errormessage  );
error_log("res_daoutrx       : ".$res_daoutrx       );
error_log("res_amount        : ".$res_amount        );
error_log("res_canceldate    : ".$res_canceldate    );
error_log(print_r('#####'.$_SERVER[PHP_SELF].'#####',true));

/* ========================================================================== */
/* =  결과코드 0000 : 성공	그외 : 실패				    = */
/* ========================================================================== */
echo "res_resultcode    : ".$res_resultcode;
echo "res_errormessage    : ".$res_errormessage;
if( $res_resultcode != "0000" ) {
	/* ================================================================== */
        /* = 	 실패 페이지 		                                    = */
        /* ================================================================== */
} else {
	/* ================================================================== */
        /* = 	 성공 페이지  		                                    = */
        /* ================================================================== */
}
?>
